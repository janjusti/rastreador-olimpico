(()=>{const e=(new Date).toISOString().split("T")[0],t={start:new Date("2024-07-24"),end:new Date("2024-08-11")},n={start:new Date("2024-08-28"),end:new Date("2024-09-08")};class s{constructor(e,t){this.hasCustomCountry=t,this.phaseName=e.phaseName,this.eventUnitName=e.eventUnitName,this.disciplineName=e.disciplineName,this.startDate=new Date(e.startDate),this.startText=e.startText,this.status=e.statusDescription,this.medalFlag=e.medalFlag,this.competitors=e.competitors,this.id=e.id,this.mode=u(this.startDate),this.url="olympics"===this.mode?`https://olympics.com${e.extraData.detailUrl}`:"paralympics"===this.mode?`https://www.paralympic.org${e.extraData.detailUrl}`:null}}var a=new URLSearchParams(window.location.search),i="BRA";let o,l;var c,r,d={};function u(e){return e>=t.start&&e<=t.end?"olympics":e>=n.start&&e<=n.end?"paralympics":null}function m(){c={},d={},o=[],l=null,document.getElementById("filters").classList.remove("filter-active"),document.getElementById("filters").innerHTML="",document.getElementById("content").innerHTML="Loading...",g()}function p(){m(),r=setInterval(g,5e3)}function h(e){document.getElementById("content").innerHTML=e,document.getElementById("medals").innerHTML="",r=clearInterval(r)}function f(){var t=document.getElementById("datePicker")?.value;return t||(t=e),t}async function g(){try{const e=function(){var e=f();const t=u(new Date(e)),n="olympics"===t?"summer":"paralympics"===t?"summer-para":null;return n?`https://sph-s-api.olympics.com/${n}/schedules/api/ENG/schedule/day/${e}`:null}();if(null===e)return void h("Nothing here today...");let t=await fetch(e,{cache:"no-cache"});if(200!==t.status)return void h(`Error ${t.status} :(`);void 0===r&&"false"===a.get("onetime")&&p();const n=w(c);c=await t.json(),n&&!w(c)&&function(){const e=document.getElementById("filters"),t=[...new Set(c.units.map((e=>e.disciplineName)))].sort(),n=document.createElement("div");n.id="special-filters";const s=document.createElement("input");s.type="checkbox",s.id="all-checkbox",s.addEventListener("change",(function(){const t=u.querySelectorAll("input#discipline-checkbox");s.checked?(u.classList.add("disabled"),o=Array.from(t).map((e=>e.value)),e.classList.add("filter-active"),t.forEach((e=>{e.checked=!0}))):(u.classList.remove("disabled"),o=[],e.classList.remove("filter-active"),t.forEach((e=>{e.checked=!1}))),b()}));const a=document.createElement("label");a.textContent="All",a.appendChild(s),n.appendChild(a);const r=document.createElement("input");r.type="checkbox",r.id="onlyNOC-checkbox",r.addEventListener("change",(function(){const e=document.getElementById("content");r.checked?(l=i,e.classList.add("noc-filter-active")):(l=null,e.classList.remove("noc-filter-active")),b()}));const d=document.createElement("label");d.textContent=`Only ${i}`,d.appendChild(r),n.appendChild(d),e.appendChild(n);const u=document.createElement("div");u.id="discipline-filters",t.forEach((t=>{const n=document.createElement("input");n.type="checkbox",n.id="discipline-checkbox",n.value=t,n.addEventListener("change",(function(){n.checked?o.push(n.value):o=o.filter((e=>e!==n.value)),0!==o.length?e.classList.add("filter-active"):e.classList.remove("filter-active"),b(),n.checked||(s.checked=!1)}));const a=document.createElement("label");a.textContent=t,a.appendChild(n),u.appendChild(a)})),e.appendChild(u)}(),d=await async function(){try{const e=u(new Date(f())),t="olympics"===e?"https://olympics.com/OG2024/data/CIS_MedalNOCs~lang=ENG~comp=OG2024.json":"paralympics"===e?"https://www.paralympic.org/OG2024/data/CIS_MedalNOCs~comp=PG2024~lang=ENG.json":null;if(null===t)return{};const n=await fetch(t,{cache:"no-cache"});if(200!==n.status)return{};const s=await n.json();if(void 0===s.medalNOC)return{};const a=new Date(n.headers.get("Last-Modified")),o=s.medalNOC.filter((e=>"TOT"===e.gender&&"GLO"===e.sport)).map((e=>({org:e.org,gold:e.gold,silver:e.silver,bronze:e.bronze,total:e.total,rank:e.rank}))).sort(((e,t)=>e.rank-t.rank)),l=o.slice(0,5),c=o.findIndex((e=>e.org===i));if(-1!==c){const e=o[c];c>0&&!l.some((e=>e.org===o[c-1].org))&&l.push(o[c-1]),c<o.length-1&&!l.some((e=>e.org===o[c+1].org))&&l.push(o[c+1]),l.some((e=>e.org===i))||l.push(e)}return{NOCs:l.sort(((e,t)=>e.rank-t.rank)),last_mod:a}}catch(e){console.error("Error fetching data:",e)}}(),b()}catch(e){console.error("Error fetching data:",e)}}function v(e){return e.liveFlag&&["interrupted"].every((t=>t!==e.status.toLowerCase()))}function y(e){return!e.liveFlag&&["finished","cancelled"].every((t=>t!==e.status.toLowerCase()))}function C(e){return"finished"===e.status.toLowerCase()}function E(e){const t=new Date,n=new Date(e);let s=n-t;const a=s>=0;a||(s=t-n);const i=Math.floor(s/864e5),o=Math.floor(s%864e5/36e5),l=Math.floor(s%36e5/6e4),c=Math.floor(s%6e4/1e3);let r="";return i>0&&(r+=`${i}d`),(o>0||i>0)&&(r+=`${o}h`),(l>0||o>0||i>0)&&(r+=`${l}m`),(c>0||!i&&!o&&!l)&&(r+=`${c}s`),a?`-${r}`:r}function w(e){for(const t in e)if(Object.hasOwn(e,t))return!1;return!0}function L(e,t){return"Getting Ready"===e.status&&!0===e.hasCustomCountry?-1:"Getting Ready"===t.status&&!0===t.hasCustomCountry?1:0!==e.medalFlag&&!0===e.hasCustomCountry?-1:0!==t.medalFlag&&!0===t.hasCustomCountry?1:!0===e.hasCustomCountry?-1:!0===t.hasCustomCountry?1:0!==e.medalFlag&&"Getting Ready"===e.status?-1:0!==t.medalFlag&&"Getting Ready"===t.status?1:"Getting Ready"===e.status?-1:"Getting Ready"===t.status?1:0!==e.medalFlag?-1:0!==t.medalFlag?1:-1}function $(e,t){return"Scheduled"!==e.status&&"Scheduled"===t.status?1:"Scheduled"===e.status&&"Scheduled"!==t.status?-1:"Rescheduled"!==e.status&&"Rescheduled"===t.status?1:"Rescheduled"===e.status&&"Rescheduled"!==t.status?-1:0}function N(e,t){const n=e.results?.position?parseInt(e.results?.position,10):null,s=t.results?.position?parseInt(t.results?.position,10):null;return null!==n&&null!==s?n-s:null!==n?-1:null!==s?1:e.order-t.order}function b(){!function(){const e=document.getElementById("medals");if(e.innerHTML="",void 0===d.NOCs||0===d.NOCs.length)return;const t=document.createElement("table"),n=u(new Date(f())),s="olympics"===n?"https://olympics.com/en/paris-2024/medals":"paralympics"===n?"https://www.paralympic.org/en/paris-2024-paralympics/medals":null;t.setAttribute("onclick",`window.open('${s}', '_blank').focus();`);const a=document.createElement("tr");["Rank","Country","Gold","Silver","Bronze","Total"].forEach((e=>{const t=document.createElement("th");t.textContent=e,a.appendChild(t)})),t.appendChild(a),d.NOCs.forEach((e=>{const n=document.createElement("tr");e.org===i&&n.classList.add("filteredNOC"),[e.rank,e.org,e.gold,e.silver,e.bronze,e.total].forEach(((e,t)=>{const s=document.createElement("td");if(1===t){s.classList.add("country");const t=document.createElement("img");t.classList.add("flag"),t.src=`https://www.paralympic.org/OG2024/assets/images/flags/PG2024/${e}.webp`,s.appendChild(t),s.appendChild(document.createTextNode(e))}else s.textContent=e;n.appendChild(s)})),t.appendChild(n)}));const o=document.createElement("span"),l=d.last_mod.toLocaleString("en-GB",{day:"2-digit",month:"2-digit",year:"numeric",hour:"2-digit",minute:"2-digit",second:"2-digit",hour12:!1}).replace(",","");o.innerText=`Latest update: ${l} (${E(d.last_mod)})`,e.appendChild(t),e.appendChild(o)}();var e,t=(e={live:[],pending:[],finished:[]},c.units.forEach((t=>{const n=t.competitors?.some((e=>e.noc===i));(n||null===l)&&(0===o.length?(v(t)&&e.live.push(new s(t,n)),(0!=t.medalFlag||n)&&(y(t)?e.pending.push(new s(t,n)):C(t)&&e.finished.push(new s(t,n)))):o.includes(t.disciplineName)&&(v(t)?e.live.push(new s(t,!1)):y(t)?e.pending.push(new s(t,!1)):C(t)&&e.finished.push(new s(t,!1))))})),e);const n=document.getElementById("content");n.innerHTML="",["pending","live","finished"].forEach((e=>{let s=t[e];if(0===s.length)return;const a=document.createElement("div");a.className=`${e}-container`;const o=document.createElement("h1");o.innerText=e.charAt(0).toUpperCase()+e.slice(1),a.appendChild(o),"pending"===e&&(s=s.sort($)),"live"===e&&(s=s.sort(L)),"finished"===e&&(s=s.slice().reverse()),s.forEach((e=>{const t=document.createElement("div");t.className="event";const n=e.startDate.toLocaleTimeString("en-US",{hour12:!1});let s=E(e.startDate),o="",l=new Set;var c=e.competitors;void 0===c&&(c=[]),(c=c.sort(N)).slice(0,4).forEach((e=>{let t=e.noc===i?" filteredNOC":"";const n=e.order+1;if(o+=`<div class="competitors${t}">${n}: ${e.name} (${e.noc})`,e.results){let t="";for(const[n,s]of Object.entries(e.results))s&&(t+=`${n}: ${s}<br>`);t&&(o+=`<br><div class="results">${t}</div>`)}o+="</div>",l.add(e.name)})),c.forEach((e=>{if(e.noc===i&&!l.has(e.name)){if(o+=`<div class="competitors filteredNOC">${e.order+1}: ${e.name} (${e.noc})`,e.results){let t="";for(const[n,s]of Object.entries(e.results))s&&(t+=`${n}: ${s}<br>`);t&&(o+=`<br><div class="results">${t}</div>`)}o+="</div>",l.add(e.name)}}));const r=document.createElement("div");r.className="eventTitle",r.innerHTML=`<span>${e.disciplineName} - ${e.eventUnitName}</span>`,0!=e.medalFlag&&r.classList.add("medal"),1===e.medalFlag&&r.classList.add("gold"),3===e.medalFlag&&r.classList.add("bronze"),"Getting Ready"===e.status&&r.classList.add("gettingReady"),r.setAttribute("onclick",`window.open('${e.url}', '_blank').focus();`);const d=document.createElement("div");d.className="eventStatus",s.startsWith("-")&&d.classList.add("futureEvent"),d.innerHTML=`${n} (${s})<br>`,d.innerHTML+=`${e.status}${""===e.startText?"":" ("+e.startText+")"}`,t.innerHTML="",t.appendChild(r),t.appendChild(d),t.innerHTML+=o,a.appendChild(t)})),n.appendChild(a)})),delete t}document.addEventListener("DOMContentLoaded",(t=>{let n=document.getElementById("datePicker");n.value=e,n.onchange=m})),p()})();